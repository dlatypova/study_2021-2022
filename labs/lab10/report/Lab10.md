---
## Front matter
title: "Лабораторная работа №10"
subtitle: "Программирование в командном процессоре ОС UNIX. Командные файлы"
author: "Латыпова Диана. НФИбд-02-21"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true # Table of contents
toc-depth: 2
lof: true # List of figures
lot: true # List of tables
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
	- spelling=modern
	- babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: PT Serif
romanfont: PT Serif
sansfont: PT Sans
monofont: PT Mono
mainfontoptions: Ligatures=TeX
romanfontoptions: Ligatures=TeX
sansfontoptions: Ligatures=TeX,Scale=MatchLowercase
monofontoptions: Scale=MatchLowercase,Scale=0.9
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float} # keep figures where there are in the text
  - \floatplacement{figure}{H} # keep figures where there are in the text
---

# Цель работы

Изучить основы программирования в оболочке ОС UNIX/Linux. Научиться писать небольшие командные файлы.

# Задание

1. Написать скрипт, который при запуске будет делать резервную копию самого себя (то есть файла, в котором содержится его исходный код) в другую директорию backup
в вашем домашнем каталоге. При этом файл должен архивироваться одним из архиваторов на выбор zip, bzip2 или tar. Способ использования команд архивации необходимо узнать, изучив справку.
2. Написать пример командного файла, обрабатывающего любое произвольное число аргументов командной строки, в том числе превышающее десять. Например, скрипт может последовательно распечатывать значения всех переданных аргументов.
3. Написать командный файл — аналог команды ls (без использования самой этой команды и команды dir). Требуется, чтобы он выдавал информацию о нужном каталоге и выводил информацию о возможностях доступа к файлам этого каталога.
4. Написать командный файл, который получает в качестве аргумента командной строки формат файла (.txt, .doc, .jpg, .pdf и т.д.) и вычисляет количество таких файлов в указанной директории. Путь к директории также передаётся в виде аргумента командной строки.

# Выполнение лабораторной работы

1. Я написала скрипт, который при запуске делал резервную копию самого себя (то есть файла, в котором содержится его исходный код) в другую директорию backup
в домашнем каталоге. При этом файл архивировался архиватором zip. 

Для начала я создала директорию backup с помощью команды mkdir(рис. [-@fig:001]):

**mkdir backup**

![Создание директории](image/1.1%20mkdir.png){ #fig:001 width=70% }

Затем запустила редактор emacs(рис. [-@fig:002]):

**emacs 10_1**

![Запуск редактора emacs(1)](image/1.2%20emacs.png){ #fig:002 width=70% }

Написала там скрипт 1 задания(рис. [-@fig:003]):

1 **zip 10_1.zip 10_1**

2 **mv 10_1.zip /home/dlatihpova/backup**

![Скрипт 1 задания](image/1.3%20code.png){ #fig:003 width=70% }

После чего закрыла редактор. Изменила код защиты командного файла 10_1, обеспечив доступ к этому файлу по
выполнению и проверила работу нашего скрипта(рис. [-@fig:004]):

1 **chmod +x 10_1**

2 **./10_1**

3 **cd backup**

4 **ls**

![10_1](image/1.4%20proverka.png){ #fig:004 width=70% }

Все работает. Перешла к выполнению второго задания.

2. Далее я написала пример командного файла, обрабатывающего любое произвольное число аргументов командной строки, в том числе превышающее десять. 

Снова запустила редактор emacs(рис. [-@fig:005]):

**emacs 10_2**

![Запуск редактора emacs(2)](image/2.1%20emacs.png){ #fig:005 width=70% }

Написала скрипт 2 задания(рис. [-@fig:006]):

1 for numb in $*

2  do echo $numb

3 done

![Скрипт 2 задания](image/2.2%20code.png){ #fig:006 width=70% }

Снова предоставила права на выполнение и проверила работу скрипта(рис. [-@fig:007]):

1 **chmod +x 10_2**

2 **./10_2 1 2 3 4 5 6 7 8 9 10 11**

![10_2](image/2.3%20proverka.png){ #fig:007 width=70% }

Скрипт работает, выводит последовательно наши аргументы. Переходим к выполнению 3 задания.

3. Написала командный файл — аналог команды ls (без использования самой этой команды и команды dir). В результате он выдавал информацию о нужном каталоге и выводил информацию о возможностях доступа к файлам этого каталога.

Запустила редактор emacs(рис. [-@fig:008]):

**emacs 10_3**

![Запуск редактора emacs(3)](image/3.1%20emacs.png){ #fig:008 width=70% }

Написала скрипт 3 задания на примере скрипта в теоретической части лабораторной работы(рис. [-@fig:009]):

1 for A in *

2 do if test -d $A

3  then echo $A: is a directory

4  else echo -n $A: "is a file and"

5      if test -w $A

6      then echo writeable

7      elif test -r $A

8      then echo readable

9      else echo neither readable nor writeable

10      fi

11  fi 

12 done

![Скрипт 3 задания](image/3.2%20code.png){ #fig:009 width=70% }

Снова предоставила права на выполнение и проверила работу скрипта(рис. [-@fig:010]):

1 **chmod +x 10_3**

2 **./10_3**

![10_3](image/3.3%20proverka.png){ #fig:010 width=70% }

И наконец, приступила к выполнению 4 задания.

4. Я написала командный файл, который получает в качестве аргумента командной строки формат файла (.txt, .doc, .jpg, .pdf и т.д.) и вычисляет количество таких файлов в указанной директории. Путь к директории также передаётся в виде аргумента командной строки.

Запустила редактор emacs(рис. [-@fig:011]):

**emacs 10_4**

![Запуск редактора emacs(4)](image/4.1%20emacs.png){ #fig:011 width=70% }

Написала скрипт 4 задания(рис. [-@fig:012]):

1 **echo "Directory path: "**

2 **read dir**

3 **echo "File format: "**

4 **read format**

5 **find $dir -name "*$format" -type f | wc -l**

![Скрипт 4 задания](image/4.2%20code.png){ #fig:012 width=70% }

И предоставила права на выполнение и проверила работу скрипта(рис. [-@fig:013]):

1 **chmod +x 10_4**

2 **./10_4**

![10_4](image/4.3%20proverka.png){ #fig:013 width=70% }

# Контрольные вопросы

1. Объясните понятие командной оболочки. Приведите примеры командных оболочек. Чем они отличаются?

Оболочка операционной системы (от англ. shell — оболочка) — интерпретатор команд операционной системы (ОС), обеспечивающий интерфейс для взаимодействия пользователя с функциями системы.

- Bash — самая распространённая оболочка под Linux. Она ведёт историю команд и предоставляет возможность их редактирования;

- pdksh — клон korn shell, хорошо известной оболочки в системах UNIX;

- tcsh — улучшенная версия >C shell;

- zsh — новейшая из перечисленных здесь оболочек; реализует улучшенное дополнение и другие удобные функции. 

У каждой оболочки свой синтаксис.

2. Что такое POSIX?

POSIX (произносится как «позикс») — это интерфейс портативных операционных систем. Во-первых, нужно обозначить область действия понятия «портативность», в этом конкретном случае, и определиться с понятием «интерфейс». Чтобы выяснить это, необходимо отталкиваться от того, что оба понятия неразрывно связаны.

3. Как определяются переменные и массивы в языке программирования bash?

Bash-массивы имеют только численные индексы, но они не обязательны к использованию, то есть вы не должны определять значения всех индексов в явном виде. Массив целиком может быть определен путем заключения записей в круглые скобки.

Kомандный процессор bash обеспечивает возможность использования переменных типа строка символов. Имена переменных могут быть выбраны пользователем. Пользователь имеет возможность присвоить переменной значение некоторой строки символов.

4. Каково назначение операторов let и read?

Команда let является показателем того, что последующие аргументы представляют собой выражение, подлежащее вычислению. Простейшее выражение - это единичный терм (term), обычно целочисленный. Целые числа можно записывать как последовательность цифр или в любом базовом формате. 

Необходимо обеспечить возможность, однажды написав программу, многократно ее использовать, вводя каждый раз другие данные. Такая гибкость в языке обеспечивается оператором Read. Этим оператором вводится информация с клавиатуры.

5. Какие арифметические операции можно применять в языке программирования bash?

let это встроенная функция bash, которая позволяет производить базовые арифметические операции.

Используется следующим образом:

**let <арифметическая операция>**

+, -, \*, / 	-Сложение, вычитание, умножение, деление

var++ 	-Увеличение переменной на 1

var-- 	-Уменьшение переменной на 1

% 	-Модуль: возвращает остаток от деления 

6. Что означает операция (( ))?

Условия оболочки bash, в двойные скобки —(( )).

7. Какие стандартные имена переменных Вам известны?

Общие имена временных переменных: i, j, k, m и n для целых чисел; c, d и e для символов.

8. Что такое метасимволы?

Метасимволы – это специальные символы, имеющие особое значение, такие как подстановочный символ, символ повторения, символ несовпадения или диапазон символов ’ < > * ? | \ " &

9. Как экранировать метасимволы?

Экранирование может быть осуществлено с помощью предшествующего метасимволу символа, который, в свою очередь, является метасимволом. Для экранирования группы метасимволов, ее нужно заключить в одинарные кавычки. Строка, заключенная в двойные кавычки, экранирует все метасимволы, кроме $, ’ , , ". Например,–echo *выведет на экран символ*,–echo ab’|’cdвыдаст строку ab*|*cd.

10. Как создавать и запускать командные файлы?

Последовательность команд может быть помещена в текстовый файл. Такой файл называется командным. Далее этот файл можно выполнить по команде bash командный_файл [аргументы] Чтобы не вводить каждый раз последовательности символов bash, необходимо изменить код защиты этого командного файла, обеспечив доступ к этому файлу по выполнению. Это может быть сделано с помощью команды chmod +x имя_файла Теперь можно вызывать свой командный файл на выполнение просто, вводя его имя с терминала так, как будто он является выполняемой программой. Командный процессор распознает, что в Вашем файле на самом деле хранится не выполняемая программа, а программа, написанная на языке программирования оболочки, и осуществит ее интерпретацию.

11. Как определяются функции в языке программирования bash?

Группу команд можно объединить в функцию. Для этого существует ключевое слово function, после которого следует имя функции и список команд, заключенных в фигурные скобки. 

Удалить функцию можно с помощью команды unset c флагом-f. 

Команда typeset имеет четыре опции для работы с функциями:

 -f — перечисляет определенные на текущий момент функции; 
 
 -ft — при последующем вызове функции инициирует ее трассировку; 
 
 -fx — экспортирует все перечисленные функции в любые дочерние программы оболочек; 
 
 -fu — обозначает указанные функции как автоматически загружаемые. Автоматически загружаемые функции хранятся в командных файлах, а при их вызове оболочка просматривает переменную FPATH, отыскивая файл с одноименными именами функций, загружает его и вызывает эти функции.

12. Каким образом можно выяснить, является файл каталогом или обычным файлом?

ls -lrt Если есть d, то является файл каталогом

13. Каково назначение команд set, typeset и unset?

Команда SET используется для просмотра и изменения переменных среды окружения в командной строке Windows. Переменные окружения - это переменные, принимаемые значения которых характеризуют среду, в которой выполняется текущая программа - пути системных файлов, сведения об аппаратных средствах, каталоги пользователя и т.п. Значения переменных среды формируются в процессе загрузки Windows, регистрации пользователя в системе, при выполнении отдельных процессов или с помощью команды SET. 

Команды declare и typeset являются встроенными и предназначены для наложения ограничений на переменные. Это попытка контроля над типами, которая имеется во многих языках программирования. Команды абсолютно идентичны друг другу и являются синонимами. 

Команда unset удаляет переменную, фактически -- устанавливает ее значение в null. Обратите внимание: эта команда не может сбрасывать позиционные параметры (аргументы).

14. Как передаются параметры в командные файлы?

Символ $ является метасимволом командного процессора. Он используется, в частности, для ссылки на параметры, точнее, для получения их значений в командном файле. В командный файл можно передать до девяти параметров.

15. Назовите специальные переменные языка bash и их назначение

**$1-$9** Это параметры командной строки. Т.е. то, что пользователь ввел через пробел после названия самого скрипта.

**$0** В этом переменной лежит путь и имя скрипта, который запустил пользователь.

**$#** Количество параметров, переданных скрипту из командной строки.

**$?** Код возврата (exit code, result code), с которым завершилась предыдущая команда. Как правило, код возврата "0" означает удачное выполнение команды, а все, что отлично от нуля - различные ошибки, причем коды ошибок четко специфичны для выполняемой команды.

**$$** PID - код процесса, в котором выполняется данный скрипт.

**$!** PID последнего процесса, который был запущен в фоне. Например, если Вы запускаете в фоне какой-то процесс, то Вам, возможно, хотелось-бы знать его PID.

$* Все параметры, переданные из командной строки, в одну строку.

# Выводы

Я изучила основы программирования в оболочке ОС UNIX/Linux и научилась писать небольшие командные файлы.
